<mat-card class="document-card" (click)="onCardClick()" [class.archived]="document.isArchived">
  <mat-card-header>
    <div class="card-header-content">
      <mat-card-title class="document-title" [matTooltip]="document.title">
        {{ document.title }}
      </mat-card-title>
      <mat-chip class="sharing-chip" [style.background-color]="getSharingLevelInfo().color">
        <span class="sharing-icon">{{ getSharingLevelInfo().icon }}</span>
        <span class="sharing-label">{{ getSharingLevelInfo().label }}</span>
      </mat-chip>
    </div>
  </mat-card-header>

  <mat-card-content>
    <p class="document-summary">{{ getTruncatedSummary() }}</p>

    <div class="document-meta">
      <div class="meta-item">
        <mat-icon class="meta-icon">description</mat-icon>
        <span class="meta-text">{{ document.fileType.toUpperCase() }}</span>
      </div>
      
      <div class="meta-item">
        <mat-icon class="meta-icon">person</mat-icon>
        <span class="meta-text">{{ document.ownerUsername }}</span>
      </div>

      <div class="meta-item">
        <mat-icon class="meta-icon">calendar_today</mat-icon>
        <span class="meta-text">{{ formatDate(document.createdAt) }}</span>
      </div>

      @if (document.versionNumber) {
        <div class="meta-item">
          <mat-icon class="meta-icon">update</mat-icon>
          <span class="meta-text">v{{ document.versionNumber }}</span>
        </div>
      }
    </div>

    <!-- Tags Display -->
    @if (document.tags && document.tags.length > 0) {
      <div class="tags-container">
        @for (tag of document.tags.slice(0, 3); track tag) {
          <mat-chip class="tag-chip">{{ tag }}</mat-chip>
        }
        @if (document.tags.length > 3) {
          <span class="more-tags">+{{ document.tags.length - 3 }} more</span>
        }
      </div>
    }

    <!-- Star Rating Display (Read-only) -->
    @if (document.averageRating !== undefined) {
      <div class="rating-container">
        @for (star of getStarArray(); track $index) {
          <mat-icon class="star-icon" [class.filled]="isStarFilled($index)">
            {{ isStarFilled($index) ? 'star' : 'star_border' }}
          </mat-icon>
        }
      </div>
    }

    <!-- Archived Badge -->
    @if (document.isArchived) {
      <div class="archived-badge">
        <mat-icon>archive</mat-icon>
        <span>Archived</span>
      </div>
    }
  </mat-card-content>

  <!-- Action Buttons -->
  @if (showActions) {
    <mat-card-actions class="card-actions" (click)="$event.stopPropagation()">
      <button mat-button type="button" color="primary" (click)="onActionClick('view', $event)" aria-label="View document">
        <mat-icon>visibility</mat-icon>
        View
      </button>
      @if (isOwner()) {
        <button mat-button type="button" color="accent" (click)="onActionClick('edit', $event)" aria-label="Edit document">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button type="button" color="warn" (click)="onActionClick('delete', $event)" aria-label="Delete document">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      }
    </mat-card-actions>
  }
</mat-card>
